<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>c't-Bot: sp03.c-Dateireferenz</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">c't-Bot
   &#160;<span id="projectnumber">1818</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Erzeugt von Doxygen 1.7.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Hauptseite</span></a></li>
      <li><a href="pages.html"><span>Zus채tzliche&#160;Informationen</span></a></li>
      <li><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li class="current"><a href="files.html"><span>Dateien</span></a></li>
      <li><a href="dirs.html"><span>Verzeichnisse</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Auflistung&#160;der&#160;Dateien</span></a></li>
      <li><a href="globals.html"><span>Datei-Elemente</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_621229fa04310f844660a72d92a68ebe.html">mcu</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Makrodefinitionen</a> &#124;
<a href="#func-members">Funktionen</a>  </div>
  <div class="headertitle">
<div class="title">sp03.c-Dateireferenz</div>  </div>
</div>
<div class="contents">

<p>Ansteuerung des Sprachmoduls SP03 Text to Speech mit TWI aka I2C.  
<a href="#details">Mehr ...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ct-Bot_8h_source.html">ct-Bot.h</a>&quot;</code><br/>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;util/twi.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="i2c_8h_source.html">i2c.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sp03_8h_source.html">sp03.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="delay_8h_source.html">delay.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include-Abh채ngigkeitsdiagramm f체r sp03.c:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c__incl.png" border="0" usemap="#sp03_8c" alt=""/></div>
<map name="sp03_8c" id="sp03_8c">
</map>
</div>
</div>
<p><a href="sp03_8c_source.html">gehe zum Quellcode dieser Datei</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Makrodefinitionen</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#ac345ab0663a801789a73d726fd0e332b">SP03_BUFFER_SIZE</a>&#160;&#160;&#160;(SP03_MAX_TEXT_SIZE+3)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Funktionen</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#a345e69a0b973c0dda7bf723df76b3f94">sp03_flash_speakf</a> (const char *format,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Laden eines Strings in den SP03, der im Flash gespeichert ist. Schreibt die formatierte Ausgabe der zu sprechenden Zeichen in einen Puffer und uebertraegt sie per I2C an das Sprachmodul. Die eigentliche Aussprache des Textes erfolgt im Macro <a class="el" href="sp03_8h.html#aa2d0ad4402876ffe9979ac7a3cac1688">sp03_say()</a> oder <a class="el" href="sp03_8h.html#a8d77f2229be5a565c0e9ccbcb81690a4">sp03_speakf()</a>.  <a href="#a345e69a0b973c0dda7bf723df76b3f94"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#ab35f888d6f3b01c1ddd5295abb0a305b">sp03_set_voice</a> (uint8_t sp03_volume, uint8_t sp03_pitch, uint8_t sp03_speed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#a244fed739066bcefc1f3d07a46faf448">sp03_cmd_speak</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#ad6619d735ad9924dae3ed1d87c32e09a">sp03_speak_phrase</a> (uint8_t sp03_pre_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sp03_8c.html#aa97f8e94923215a97e551614d75ad390">sp03_get_version</a> (void)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Ausf체hrliche Beschreibung</h2>
<div class="textblock"><p>Ansteuerung des Sprachmoduls SP03 Text to Speech mit TWI aka I2C. </p>
<p>Weitere Dokumentation unter Documentation/sp03.pdf</p>
<p>Ein sprechender Roboter ist die Wunschvorstellung vieler Roboterkonstrukteure. Das hier vorgestellte SP03 Modul von Devantech Inc. ermoeglicht die direkte Umwandlung von ASCII-Zeichen in Sprache, ein moderner Sprachsynthesizer von Winbond machts moeglich. Das Board verfuegt bereits ueber Verstaerker und Lautsprecher. Die Ansteuerung erfolgt ueber I2C. Zusaetzlich koennen bis zu 30 gespeicherte Saetze auf Knopfdruck abgerufen werden.</p>
<p>So geht's: Die Parameter und der Text werden separat geschickt, gefolgt von einem "Sprich-jetzt!-Befehl" Dies sieht ungefaehr so aus:</p>
<p>--- BEGIN I2C CONTAINER --- // Stimmenparameter werden gesendet # 0xc4 I2C Adresse 0 0x0 Kommandoregister 1 0x0 NOP - Register 2 0x1 Volume //(0-7) 0=am lautesten 3 0x3 Pitch //(0-7) 0=am hoechsten 4 0x5 Speed //(0-3) 0=am langsamsten --- END I2C CONTAINER ---</p>
<p>--- BEGIN I2C CONTAINER --- // Text wird in Buffer geladen # 0xc4 I2C Adresse 0 0x0 Kommandoregister 1 0x0 NOP - Register 2 0x48 H 3 0x65 e 4 0x6c l 5 0x6c l 6 0x6f o 7 0x0 NOP - Register --- END I2C CONTAINER ---</p>
<p>--- BEGIN I2C CONTAINER --- // Sprachausgabe # 0xc4 I2C Adresse 0 0x0 Kommandoregister 1 0x40 Speak Buffer --- END I2C CONTAINER ---</p>
<p>Das Benutzerinterface funktioniert wie folgt:</p>
<p># include "sp03.h" ... //Mit Stimmenparameter sp03_set_voice(2,3,1); sp03_speakf("I am %d", sensError);</p>
<p>//Kurzfassung, mit Defaultwerten sp03_say("I am %d", sensError);</p>
<dl class="author"><dt><b>Autor:</b></dt><dd>Harald W. Leschner (<a href="mailto:hari@h9l.net">hari@h9l.net</a>) </dd></dl>
<dl class="date"><dt><b>Datum:</b></dt><dd>29.03.08 </dd></dl>

<p>Definiert in Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>
</div><hr/><h2>Makro-Dokumentation</h2>
<a class="anchor" id="ac345ab0663a801789a73d726fd0e332b"></a><!-- doxytag: member="sp03.c::SP03_BUFFER_SIZE" ref="ac345ab0663a801789a73d726fd0e332b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SP03_BUFFER_SIZE&#160;&#160;&#160;(SP03_MAX_TEXT_SIZE+3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000027">Noch zu erledigen:</a></b></dt><dd><p class="startdd">: Abfragen von STATUS bevor neues Sprechen </p>
<p>: Ein eigenes Behaviour, LOG_SAY und RemoteCall anlegen ... </p>
<p>: Fehler abfangen und evtl. sprachlich ausgeben </p>
<p class="enddd">: testen wirklich langer und komplizierter Texte ... </p>
</dd></dl>
<p>Puffergroesse fuer einen Satz in Bytes </p>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00102">102</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Wird benutzt von <a class="el" href="sp03_8c_source.html#l00113">sp03_flash_speakf()</a>.</p>

</div>
</div>
<hr/><h2>Dokumentation der Funktionen</h2>
<a class="anchor" id="a244fed739066bcefc1f3d07a46faf448"></a><!-- doxytag: member="sp03.c::sp03_cmd_speak" ref="a244fed739066bcefc1f3d07a46faf448" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sp03_cmd_speak </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SP03 Steuercode fuer Sprechen senden </p>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00163">163</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Benutzt <a class="el" href="sp03_8h_source.html#l00035">SP03_COMMAND_REG</a>, <a class="el" href="sp03_8h_source.html#l00039">SP03_SPEAK_BUFFER</a>, <a class="el" href="sp03_8h_source.html#l00034">SP03_TWI_ADDRESS</a> und <a class="el" href="i2c_8c_source.html#l00186">i2c_wait()</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c_a244fed739066bcefc1f3d07a46faf448_cgraph.png" border="0" usemap="#sp03_8c_a244fed739066bcefc1f3d07a46faf448_cgraph" alt=""/></div>
<map name="sp03_8c_a244fed739066bcefc1f3d07a46faf448_cgraph" id="sp03_8c_a244fed739066bcefc1f3d07a46faf448_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a345e69a0b973c0dda7bf723df76b3f94"></a><!-- doxytag: member="sp03.c::sp03_flash_speakf" ref="a345e69a0b973c0dda7bf723df76b3f94" args="(const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sp03_flash_speakf </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Laden eines Strings in den SP03, der im Flash gespeichert ist. Schreibt die formatierte Ausgabe der zu sprechenden Zeichen in einen Puffer und uebertraegt sie per I2C an das Sprachmodul. Die eigentliche Aussprache des Textes erfolgt im Macro <a class="el" href="sp03_8h.html#aa2d0ad4402876ffe9979ac7a3cac1688">sp03_say()</a> oder <a class="el" href="sp03_8h.html#a8d77f2229be5a565c0e9ccbcb81690a4">sp03_speakf()</a>. </p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">format</td><td>Format, wie beim printf </td></tr>
    <tr><td class="paramname">...</td><td>Variable Argumentenliste, wie beim printf </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00113">113</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Benutzt <a class="el" href="sp03_8c_source.html#l00102">SP03_BUFFER_SIZE</a>, <a class="el" href="sp03_8h_source.html#l00035">SP03_COMMAND_REG</a>, <a class="el" href="sp03_8h_source.html#l00038">SP03_COMMAND_NOP</a>, <a class="el" href="sp03_8h_source.html#l00045">SP03_MAX_TEXT_SIZE</a>, <a class="el" href="sp03_8h_source.html#l00034">SP03_TWI_ADDRESS</a> und <a class="el" href="i2c_8c_source.html#l00186">i2c_wait()</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c_a345e69a0b973c0dda7bf723df76b3f94_cgraph.png" border="0" usemap="#sp03_8c_a345e69a0b973c0dda7bf723df76b3f94_cgraph" alt=""/></div>
<map name="sp03_8c_a345e69a0b973c0dda7bf723df76b3f94_cgraph" id="sp03_8c_a345e69a0b973c0dda7bf723df76b3f94_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa97f8e94923215a97e551614d75ad390"></a><!-- doxytag: member="sp03.c::sp03_get_version" ref="aa97f8e94923215a97e551614d75ad390" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sp03_get_version </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SP03 Firmwareversion auslesen </p>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00205">205</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Benutzt <a class="el" href="i2c_8c_source.html#l00176">i2c_read()</a>, <a class="el" href="sp03_8h_source.html#l00034">SP03_TWI_ADDRESS</a>, <a class="el" href="sp03_8h_source.html#l00036">SP03_VERSION_REG</a>, <a class="el" href="i2c_8c_source.html#l00186">i2c_wait()</a>, <a class="el" href="log_8h_source.html#l00307">LOG_INFO</a> und <a class="el" href="sp03_8h_source.html#l00070">sp03_say</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c_aa97f8e94923215a97e551614d75ad390_cgraph.png" border="0" usemap="#sp03_8c_aa97f8e94923215a97e551614d75ad390_cgraph" alt=""/></div>
<map name="sp03_8c_aa97f8e94923215a97e551614d75ad390_cgraph" id="sp03_8c_aa97f8e94923215a97e551614d75ad390_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab35f888d6f3b01c1ddd5295abb0a305b"></a><!-- doxytag: member="sp03.c::sp03_set_voice" ref="ab35f888d6f3b01c1ddd5295abb0a305b" args="(uint8_t sp03_volume, uint8_t sp03_pitch, uint8_t sp03_speed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sp03_set_voice </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sp03_volume</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sp03_pitch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sp03_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SP03 Steuercodes fuer Lautstaerke, Speed und Pitch an Synth senden </p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sp03_volume</td><td>Lautstaerke </td></tr>
    <tr><td class="paramname">sp03_pitch</td><td>Geschwindigkeit </td></tr>
    <tr><td class="paramname">sp03_speed</td><td>Stimmlage </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00143">143</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Benutzt <a class="el" href="sp03_8h_source.html#l00035">SP03_COMMAND_REG</a>, <a class="el" href="sp03_8h_source.html#l00038">SP03_COMMAND_NOP</a>, <a class="el" href="sp03_8h_source.html#l00034">SP03_TWI_ADDRESS</a> und <a class="el" href="i2c_8c_source.html#l00186">i2c_wait()</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c_ab35f888d6f3b01c1ddd5295abb0a305b_cgraph.png" border="0" usemap="#sp03_8c_ab35f888d6f3b01c1ddd5295abb0a305b_cgraph" alt=""/></div>
<map name="sp03_8c_ab35f888d6f3b01c1ddd5295abb0a305b_cgraph" id="sp03_8c_ab35f888d6f3b01c1ddd5295abb0a305b_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad6619d735ad9924dae3ed1d87c32e09a"></a><!-- doxytag: member="sp03.c::sp03_speak_phrase" ref="ad6619d735ad9924dae3ed1d87c32e09a" args="(uint8_t sp03_pre_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sp03_speak_phrase </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>sp03_pre_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SP03 Vordefinierte Saetze abrufen 1-30 oder 0x01-0x1E </p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sp03_pre_id</td><td>Vordefinierte Satz-ID-Nr </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="sp03_8c_source.html#l00181">181</a> der Datei <a class="el" href="sp03_8c_source.html">sp03.c</a>.</p>

<p>Benutzt <a class="el" href="sp03_8h_source.html#l00046">SP03_MAXNUMPHRASES</a>, <a class="el" href="sp03_8h_source.html#l00048">SP03_DEFAULT_PHRASE</a>, <a class="el" href="sp03_8h_source.html#l00035">SP03_COMMAND_REG</a>, <a class="el" href="sp03_8h_source.html#l00038">SP03_COMMAND_NOP</a>, <a class="el" href="sp03_8h_source.html#l00034">SP03_TWI_ADDRESS</a> und <a class="el" href="i2c_8c_source.html#l00186">i2c_wait()</a>.</p>

<p><div class="dynheader">
Hier ist ein Graph der zeigt, was diese Funktion aufruft:</div>
<div class="dyncontent">
<div class="center"><img src="sp03_8c_ad6619d735ad9924dae3ed1d87c32e09a_cgraph.png" border="0" usemap="#sp03_8c_ad6619d735ad9924dae3ed1d87c32e09a_cgraph" alt=""/></div>
<map name="sp03_8c_ad6619d735ad9924dae3ed1d87c32e09a_cgraph" id="sp03_8c_ad6619d735ad9924dae3ed1d87c32e09a_cgraph">
</map>
</div>
</p>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Erzeugt am Don Aug 18 2011 12:13:06 f체r c't-Bot von &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5
</small></address>

</body>
</html>
